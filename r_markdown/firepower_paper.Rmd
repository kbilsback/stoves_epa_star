---
title: "Figures for Firepower Sweep Paper"
output:
  html_document:
    toc: true
    toc_float: true
    theme: paper
---

```{r load_libraries, echo=FALSE, message=FALSE}
  library(tidyverse)
```

```{r global_options, include=FALSE}
  knitr::opts_chunk$set(fig.path='figures/', warning=FALSE, message=FALSE, cache=FALSE, echo=FALSE)
```

```{r load_data}
  # load data
  lab_data <- readRDS("../r_files/lab_grav_merged.RDS")
```

```{r load_functions}
  # load functions
  source("../r_scripts/lab_model_metrics.R")
  source("../r_scripts/functions.R")
```

## Exploratory plots

```{r}
  # lab_data %>%
  #   dplyr::filter(stove == "rocket elbow (envirofit)") %>%
  #   dplyr::filter(var == "fp") %>%
  #   ggplot(aes(x = sample_id, y = val)) +
  #     geom_point(aes(color = id)) +
  #     theme_bw() + 
  #     theme(text = element_text(size=12)) +
  #     facet_wrap(~fuel_type, ncol = 1, scales = "free")
```

```{r}
  # lab_data %>%
  #   dplyr::filter(stove == "rocket elbow (envirofit)") %>%
  #   dplyr::filter(var == "mce") %>%
  #   ggplot(aes(x = sample_id, y = val)) +
  #     geom_point(aes(color = id)) +
  #     theme_bw() + 
  #     theme(text = element_text(size=12)) +
  #     facet_wrap(~fuel_type, ncol = 1, scales = "free")
```

```{r, fig.height=20}
  lab_data %>%
    dplyr::filter(grepl("continuous", fuel_type)) %>%
    dplyr::filter(grepl("fp|mce", var)) %>%
    dplyr::select(-units) %>%
    tidyr::spread(var, val) %>%
    ggplot(aes(x = fp, y = mce, color = sample_id)) +
      geom_point() +
      theme_bw() + 
      theme(text = element_text(size=12)) +
      facet_wrap(stove~fuel, ncol = 2, scales = "free")
```

```{r, fig.height=20}
  lab_data %>%
    dplyr::filter(grepl("batch-fed\ncharcoal protocol", fuel_type)) %>%
    dplyr::filter(grepl("fp|mce", var)) %>%
    dplyr::select(-units) %>%
    tidyr::spread(var, val) %>%
    ggplot(aes(x = fp, y = mce, color = sample_id)) +
      geom_point() +
      theme_bw() + 
      theme(text = element_text(size=12)) +
      facet_wrap(stove~fuel, ncol = 2, scales = "free")
```

```{r, fig.height=20}
  lab_data %>%
    dplyr::filter(grepl("batch-fed\nwood protocol", fuel_type)) %>%
    dplyr::filter(grepl("fp|mce", var)) %>%
    dplyr::select(-units) %>%
    tidyr::spread(var, val) %>%
    ggplot(aes(x = fp, y = mce, color = sample_id)) +
      geom_point() +
      theme_bw() + 
      theme(text = element_text(size=12)) +
      facet_wrap(stove~fuel, ncol = 2, scales = "free")
```

```{r}
  # lab_data %>%
  #   dplyr::filter(stove == "rocket elbow (envirofit)") %>%
  #   dplyr::filter(fuel == "eucalyptus") %>%
  #   dplyr::filter(grepl("fp|mce", var)) %>%
  #   dplyr::select(-units) %>%
  #   tidyr::spread(var, val) %>%
  #   ggplot(aes(x = fp, y = mce, color = sample_id)) +
  #     geom_point() +
  #     theme_bw() + 
  #     theme(text = element_text(size=12)) +
  #     facet_wrap(~fuel_type, ncol = 1, scales = "free")
```

```{r}
  lab_data %>%
    dplyr::filter(var == "pm_rate") %>%
    ggplot(aes(x = sample_id, y = val)) +
      geom_boxplot(aes(color = stove), outlier.color = NA) +
      theme_bw() + 
      theme(text = element_text(size=12)) +
      facet_wrap(~fuel_type, ncol = 1, scales = "free")
```

```{r}
  lab_data %>%
    dplyr::filter(var == "pm_rate") %>%
    ggplot(aes(x = sample_id, y = val)) +
      geom_boxplot(aes(color = fuel), outlier.color = NA) +
      theme_bw() + 
      theme(text = element_text(size=12)) +
      facet_wrap(~fuel_type, ncol = 1, scales = "free")
```

```{r}
  # lab_data %>%
  #   dplyr::filter(var == "pm_rate") %>%
  #   ggplot(aes(x = fuel_type, y = val)) +
  #     geom_boxplot() +
  #     theme_bw() + 
  #     theme(text = element_text(size=16))
```

```{r}
  # lab_data %>%
  #   dplyr::filter(var == "pm_rate") %>%
  #   ggplot(aes(x = id, y = val)) +
  #     geom_boxplot() +
  #     theme_bw() + 
  #     theme(text = element_text(size=16))
```

```{r}
  # lab_data %>%
  #   dplyr::filter(var == "pm_rate") %>%
  #   ggplot(aes(x = stove, y = val)) +
  #     geom_boxplot() +
  #     theme_bw() + 
  #     theme(text = element_text(size=16))
```

```{r}
  # lab_data %>%
  #   dplyr::filter(var == "pm_rate") %>%
  #   ggplot(aes(x = fuel, y = val)) +
  #     geom_boxplot() +
  #     theme_bw() + 
  #     theme(text = element_text(size=16))
```