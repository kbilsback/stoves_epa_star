---
title: "Figures for Firepower Sweep Paper"
output:
  html_document:
    toc: true
    toc_float: true
    theme: paper
---

```{r load_libraries, echo=FALSE, message=FALSE}
  library(tidyverse)
```

```{r global_options, include=FALSE}
  knitr::opts_chunk$set(fig.path='figures/', warning=FALSE, message=FALSE, cache=FALSE, echo=FALSE)
```

```{r load_data}
  # load data
  lab_grav <- readRDS("../r_files/lab_grav_merged.RDS")
```

```{r load_functions}
  # load functions
  source("../r_scripts/lab_model_metrics.R")
  source("../r_scripts/functions.R")
```

```{r load_meta}
  # load metadata
  lab_samples <- readRDS("../r_files/lab_meta.RDS")
```

```{r}
  # select bc emissions rate as outcome
  # merge with metadata
  # select only wood tests
  # filter out Okote tests
  lab_data <- lab_grav %>%
              dplyr::left_join(lab_samples, by = "id")
```

## Exploratory plots

```{r}
  lab_data %>%
    dplyr::filter(fuel_type == "pellets") %>%
    dplyr::filter(var == "pm_rate") %>%
    ggplot(aes(x = sample_id, y = val)) +
      geom_boxplot(aes(color = fuel), outlier.color = NA) +
      theme_bw() + 
      theme(text = element_text(size=12)) +
      facet_wrap(~fuel_type, ncol = 1, scales = "free")
```

```{r}
  lab_data %>%
    dplyr::filter(var == "pm_rate") %>%
    ggplot(aes(x = sample_id, y = val)) +
      geom_boxplot(aes(color = stove), outlier.color = NA) +
      theme_bw() + 
      theme(text = element_text(size=12)) +
      facet_wrap(~fuel_type, ncol = 1, scales = "free")
```

```{r}
  lab_data %>%
    dplyr::filter(var == "pm_rate") %>%
    ggplot(aes(x = sample_id, y = val)) +
      geom_boxplot(aes(color = fuel), outlier.color = NA) +
      theme_bw() + 
      theme(text = element_text(size=12)) +
      facet_wrap(~fuel_type, ncol = 1, scales = "free")
```

```{r}
  # lab_data %>%
  #   dplyr::filter(var == "pm_rate") %>%
  #   ggplot(aes(x = fuel_type, y = val)) +
  #     geom_boxplot() +
  #     theme_bw() + 
  #     theme(text = element_text(size=16))
```

```{r}
  # lab_data %>%
  #   dplyr::filter(var == "pm_rate") %>%
  #   ggplot(aes(x = id, y = val)) +
  #     geom_boxplot() +
  #     theme_bw() + 
  #     theme(text = element_text(size=16))
```

```{r}
  # lab_data %>%
  #   dplyr::filter(var == "pm_rate") %>%
  #   ggplot(aes(x = stove, y = val)) +
  #     geom_boxplot() +
  #     theme_bw() + 
  #     theme(text = element_text(size=16))
```

```{r}
  # lab_data %>%
  #   dplyr::filter(var == "pm_rate") %>%
  #   ggplot(aes(x = fuel, y = val)) +
  #     geom_boxplot() +
  #     theme_bw() + 
  #     theme(text = element_text(size=16))
```